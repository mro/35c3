<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Lecture: Breaking Microsoft Edge Extensions Security Policies | Saturday | Schedule 36th Chaos Communication Congress
</title>
<link rel="stylesheet" media="screen" href="/congress/2019/Fahrplan/public_schedule.css">
<link rel="stylesheet" media="all" href="/congress/2019/Fahrplan/style.css">
<link rel="stylesheet" media="print" href="/congress/2019/Fahrplan/public_schedule_print.css">
<meta name="viewport" content="width=device-width, initial-scale=1"></head>
<body>
<div id="wrapper">
<div id="banner"></div>
<div id="header">
<h1>Schedule 36th Chaos Communication Congress</h1>
</div>
<div id="navigation">
<ul>
<li>
<a href="/congress/2019/Fahrplan/index.html">Overview</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/1.html">
Friday
 - 
<span class="small-font">2019-12-27</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/2.html">
Saturday
 - 
<span class="small-font">2019-12-28</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/3.html">
Sunday
 - 
<span class="small-font">2019-12-29</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/4.html">
Monday
 - 
<span class="small-font">2019-12-30</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/speakers.html">Speakers</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/events.html">Events</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/timeline.html">timeline</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/booklet.html">book</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/qrcode.html">QR-Code</a>
</li>
</ul>

</div>
<div id="main-content">
<p class="release">Version locate</p>
<h2>Lecture: Breaking Microsoft Edge Extensions Security Policies</h2>
<h3 class="title"></h3>
<div class="column left" id="basic">
<div class="image large"><img src="/congress/2019/Fahrplan/assets/event_large-4b8aa978adbb7c8e80151f5a83c6782a12e763374ae3a042a55e7e626a64d93b.png"></div>
<p class="abstract">Browsers are the ones who handle our sensitive information. We entirely rely on them to protect our privacy, that’s something blindly trusting on a piece of software to protect us. Almost every one of us uses browser extensions on daily life, for example, ad-block plus, Grammarly, LastPass, etc.</p>
<p class="description">But what is the reality when we talk about security of browser extensions.</p>

<p class="description">Every browser extensions installed with specific permissions, the most critical one is host access permission which defines on which particular domains your browser extension can read/write data.</p>

<p class="description">You might already notice the sensitivity of host permissions since a little mistake in the implementation flow would lead to a massive security/privacy violation.</p>

<p class="description">You can think of this way when you install an extension that has permission to execute JavaScript code on https://www.bing.com, but indeed, it allows javaScript code execution on https://mail.google.com. Which means this extension can also read your google mail, and this violates user privacy and trust.</p>

<p class="description">During the research on edge extensions, we noticed a way to bypass host access permissions which means an extension which has permission to work on bing.com can read your google, facebook, almost every site data.</p>

<p class="description">we noticed using this flow we can change in internal browser settings, Further, we ware able to read local system files using the extensions. Also in certain conditions, it allows you to execute javaScript on reading mode which is meant to protect users from any javaScript code execution issues.</p>

<p class="description">This major flaw in Microsoft Edge extension has been submitted responsibly to the Microsoft Security Team; as a result, CVE-2019-0678 assigned with the highest possible bounty.</p>

<p class="description">Outline</p>

<p class="description">1. Introduction to the browser extension
<br>This section is going to cover what is browser extensions, and examples of browser extensions that are used on a daily basis.</p>

<p class="description">2. Permission model in browser extensions
<br>This section details about the importance of manifest.json file, further details about several permissions supported by edge extensions and at last it describes different host access permissions and the concept of privileged pages in browsers.</p>

<p class="description">3. Implementation of sample extension
<br>In this section, we will understand the working of edge extensions and associated files.</p>

<p class="description">4. Playing with Tabs API
<br>This section includes the demonstration of loading external websites, local files and privileged pages using the tabs API.</p>

<p class="description">5. Forcing edge extensions to load local files and privileged pages
<br>Here we will see how I fooled edge extensions to allow me to load local files and privileged pages as well.</p>

<p class="description">6. Overview of javascript protocol
<br>This section brief about the working and the use of JavaScript protocol.</p>

<p class="description">7. Bypassing host access permission
<br>The continuing previous section, here we will discuss I was able to bypass host access permission of edge extensions using the javascript URI’s.</p>

<p class="description">8. Stealing google mails
<br>Once we bypassed the host access permission, we will discuss how edge extension can read your Google emails without having permission.</p>

<p class="description">9. Stealing local files
<br>The continuing previous section, here we will discuss how an edge extension can again escalate his privileges to read local system files.</p>

<p class="description">10. Changing internal edge settings
<br>This section details how I was able to change into internal edge settings using edge extensions, this includes enabling/disabling flash, enabling/disabling developer features.</p>

<p class="description">11. Force Update Compatibility list
<br>This section details how an extension can force update Microsoft compatibility list</p>

<p class="description">12. javascript code execution on reading mode?
<br>Here we will dicuss about the working of reading mode and CSP issues associated with it.</p>

<p class="description">13. Escalating CSP privileges.
<br>This section describes how edge extensions provides more privilages to the user when dealing with content security policy</p>
</div>
<div class="column left" id="details">
<h3>Info</h3>
<p>
<b>Day:</b>
<a href="/congress/2019/Fahrplan/schedule/2.html">2019-12-28</a>
<br>
<b>Start time:</b>
17:10
<br>
<b>Duration:</b>
00:40
<br>
<b>Room:</b>
Eliza
<br>
<b>Track:</b>
<font class="event track-security">
<a href="/congress/2019/Fahrplan/events.html#security">Security</a>
</font>
<br>
<b>Language:</b>
en
</p>
<h3>Links:</h3>
<ul>
<li><a href="/congress/2019/Fahrplan/events/11186.ics">iCalendar</a></li>
</ul>
<h3>Feedback</h3>
<p>
<a href="https://frab.cccv.de/en/36c3/public/events/11186/feedback/new">Click here to let us know how you liked this event.</a>
</p>
<div class="column left" id="concurrent_events">
<h3>Concurrent Events</h3>
<dl class="dl-horizontal">
</dl>
</div>
</div>
<div class="column right" id="sidebar">
<h3>Speakers</h3>
<table class="list">
<tbody>
<tr>
<td><div class="image small"><img src="/congress/2019/Fahrplan/system/people/avatars/000/008/928/small/IMG_6401.JPG"></div></td>
<td><a href="/congress/2019/Fahrplan/speakers/8928.html">Nikhil Mittal</a></td>
</tr>
</tbody>
</table>
</div>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Event",
  "name" : "Breaking Microsoft Edge Extensions Security Policies",
  "location" : {
    "@type" : "Place",
    "name" : "Eliza",
    "address" : "36th Chaos Communication Congress"
  },
  "startDate" : "2019-12-28T17:10:00+0100",
  "endDate" : "2019-12-28T17:50:00+0100",
  "performer" : [{&quot;name&quot;:&quot;Nikhil Mittal&quot;,&quot;@type&quot;:&quot;Person&quot;,&quot;sameAs&quot;:&quot;/en/36c3/public/speakers/8928&quot;,&quot;image&quot;:&quot;/system/people/avatars/000/008/928/small/IMG_6401.JPG?1574191093&quot;}],
  "inLanguage" : "en",
  "superEvent" : {
    "@type" : "Event",
    "sameAs" : "/en/36c3/public/schedule",
    "name" : "36th Chaos Communication Congress",
    "location" : {
      "@type" : "Place",
      "name" : "36th Chaos Communication Congress",
      "address" : "36th Chaos Communication Congress"
    },
    "startDate" : "2019-12-27T11:00:00+0100"
  }
}

</script>

<br class="clear">
</div>
</div>
<div id="footer">
<p>This schedule was generated with <a href="http://frab.github.io/frab/">frab</a>.</p>
</div>
</body>
</html>
