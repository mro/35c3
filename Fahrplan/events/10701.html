<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Lecture: SELECT code_execution FROM * USING SQLite; | Friday | Schedule 36th Chaos Communication Congress
</title>
<link rel="stylesheet" media="screen" href="/congress/2019/Fahrplan/public_schedule.css">
<link rel="stylesheet" media="all" href="/congress/2019/Fahrplan/style.css">
<link rel="stylesheet" media="print" href="/congress/2019/Fahrplan/public_schedule_print.css">
<meta name="viewport" content="width=device-width, initial-scale=1"></head>
<body>
<div id="wrapper">
<div id="banner"></div>
<div id="header">
<h1>Schedule 36th Chaos Communication Congress</h1>
</div>
<div id="navigation">
<ul>
<li>
<a href="/congress/2019/Fahrplan/index.html">Overview</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/1.html">
Friday
 - 
<span class="small-font">2019-12-27</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/2.html">
Saturday
 - 
<span class="small-font">2019-12-28</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/3.html">
Sunday
 - 
<span class="small-font">2019-12-29</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/schedule/4.html">
Monday
 - 
<span class="small-font">2019-12-30</span>
</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/speakers.html">Speakers</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/events.html">Events</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/timeline.html">timeline</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/booklet.html">book</a>
</li>
<li>
<a href="/congress/2019/Fahrplan/qrcode.html">QR-Code</a>
</li>
</ul>

</div>
<div id="main-content">
<p class="release">Version mkdir</p>
<h2>Lecture: SELECT code_execution FROM * USING SQLite;</h2>
<h3 class="title">--Gaining code execution using a malicious SQLite database</h3>
<div class="column left" id="basic">
<div class="image large"><img src="/congress/2019/Fahrplan/assets/event_large-4b8aa978adbb7c8e80151f5a83c6782a12e763374ae3a042a55e7e626a64d93b.png"></div>
<p class="abstract">SQLite is one of the most deployed software in the world. However, from a security perspective, it has only been examined through the narrow lens of WebSQL and browser exploitation. We believe that this is just the tip of the iceberg.
<br>In our long term research, we experimented with the exploitation of memory corruption issues within SQLite without relying on any environment other than the SQL language. Using our innovative techniques of Query Hijacking and Query Oriented Programming, we proved it is possible to reliably exploit memory corruptions issues in the SQLite engine. We demonstrate these techniques a couple of real-world scenarios: pwning a password stealer backend server, and achieving iOS persistency with higher privileges.</p>
<p class="description">Everyone knows that databases are the crown jewels from a hacker's point of view, but what if you could use a database as the hacking tool itself? We discovered that simply querying a malicious SQLite database - can lead to Remote Code Execution. We used undocumented SQLite3 behavior and memory corruption vulnerabilities to take advantage of the assumption that querying a database is safe.</p>

<p class="description">How? We created a rogue SQLite database that exploits the software used to open it.Exploring only a few of the possibilities this presents we’ll pwn password stealer backends while they parse credentials files and achieve iOS persistency by replacing its Contacts database…</p>

<p class="description">The landscape is endless (Hint: Did someone say Windows 10 0-day?). This is extremely terrifying since SQLite3 is now practically built-in to any modern system.</p>

<p class="description">In our talk we also discuss the SQLite internals and our novel approach for abusing them. We had to invent our own ROP chain technique using nothing but SQL CREATE statements. We used JOIN statements for Heap Spray and SELECT subqueries for x64 pointer unpacking and arithmetics. It's a new world of using the familiar Structured Query Language for exploitation primitives,laying the foundations for a generic leverage of memory corruption issues in database engines.</p>
</div>
<div class="column left" id="details">
<h3>Info</h3>
<p>
<b>Day:</b>
<a href="/congress/2019/Fahrplan/schedule/1.html">2019-12-27</a>
<br>
<b>Start time:</b>
23:30
<br>
<b>Duration:</b>
01:00
<br>
<b>Room:</b>
Dijkstra
<br>
<b>Track:</b>
<font class="event track-security">
<a href="/congress/2019/Fahrplan/events.html#security">Security</a>
</font>
<br>
<b>Language:</b>
en
</p>
<h3>Links:</h3>
<ul>
<li><a href="/congress/2019/Fahrplan/events/10701.ics">iCalendar</a></li>
<li><a href="https://research.checkpoint.com/select-code_execution-from-using-sqlite/">A detailed whitepaper of the vulnerabilities and exploitation technique </a></li>
</ul>
<h3>Files</h3>
<ul>
<li><a href="/congress/2019/Fahrplan/system/event_attachments/attachments/000/004/053/original/36C3-SQLite3-OmerGull.pdf">36C3-SQLite3-OmerGull.pdf</a></li>
</ul>
<h3>Feedback</h3>
<p>
<a href="https://frab.cccv.de/en/36c3/public/events/10701/feedback/new">Click here to let us know how you liked this event.</a>
</p>
<div class="column left" id="concurrent_events">
<h3>Concurrent Events</h3>
<dl class="dl-horizontal">
</dl>
</div>
</div>
<div class="column right" id="sidebar">
<h3>Speakers</h3>
<table class="list">
<tbody>
<tr>
<td><div class="image small"><img src="/congress/2019/Fahrplan/system/people/avatars/000/009/516/small/_A8B5479.jpg"></div></td>
<td><a href="/congress/2019/Fahrplan/speakers/9516.html">OmerGull</a></td>
</tr>
</tbody>
</table>
</div>
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Event",
  "name" : "SELECT code_execution FROM * USING SQLite;",
  "location" : {
    "@type" : "Place",
    "name" : "Dijkstra",
    "address" : "36th Chaos Communication Congress"
  },
  "startDate" : "2019-12-27T23:30:00+0100",
  "endDate" : "2019-12-28T00:30:00+0100",
  "performer" : [{&quot;name&quot;:&quot;OmerGull&quot;,&quot;@type&quot;:&quot;Person&quot;,&quot;sameAs&quot;:&quot;/en/36c3/public/speakers/9516&quot;,&quot;image&quot;:&quot;/system/people/avatars/000/009/516/small/_A8B5479.jpg?1576700242&quot;}],
  "inLanguage" : "en",
  "superEvent" : {
    "@type" : "Event",
    "sameAs" : "/en/36c3/public/schedule",
    "name" : "36th Chaos Communication Congress",
    "location" : {
      "@type" : "Place",
      "name" : "36th Chaos Communication Congress",
      "address" : "36th Chaos Communication Congress"
    },
    "startDate" : "2019-12-27T11:00:00+0100"
  }
}

</script>

<br class="clear">
</div>
</div>
<div id="footer">
<p>This schedule was generated with <a href="http://frab.github.io/frab/">frab</a>.</p>
</div>
</body>
</html>
